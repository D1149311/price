<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Prices</title>
</head>
<body>
<h1>Product Prices</h1>

<h2>Add a New Product</h2>
<form id="product-form">
    <label for="date">Date:</label>
    <input type="date" id="date" name="date" required><br><br>
    <label for="name">Product Name:</label>
    <input type="text" id="name" name="name" required><br><br>
    <label for="price">Price:</label>
    <input type="number" step="0.01" id="price" name="price" required><br><br>
    <button type="submit">Add Product</button>
</form>

<h2>Product Prices List</h2>
<button onclick="fetchPrices()">Fetch Prices</button>
<div id="result"></div>

<script>
    document.getElementById('product-form').addEventListener('submit', async function(event) {
        event.preventDefault();
        const date = document.getElementById('date').value;
        const name = document.getElementById('name').value;
        const price = document.getElementById('price').value;

        const response = await fetch('http://localhost:3001/add-product', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ date, name, price })
        });
        const data = await response.json();
        if (data.id) {
            alert('Product added successfully!');
            document.getElementById('product-form').reset();
        } else {
            alert('Error adding product');
        }
    });

    async function fetchPrices() {
        const response = await fetch('http://localhost:3001/prices');
        const data = await response.json();

        let output = '<table border="1"><tr><th>ID</th><th>Date</th><th>Product Name</th><th>Price</th></tr>';
        data.forEach(price => {
            output += `<tr><td>${price.id}</td><td>${price.date}</td><td>${price.name}</td><td>$${price.price.toFixed(2)}</td></tr>`;
        });
        output += '</table>';

        document.getElementById('result').innerHTML = output;
    }
</script>
</body>
</html>
